(()=>{var t={3235:()=>{},8709:(t,e,i)=>{"use strict";i.d(e,{X:()=>w});const n=flarum.core.compat["admin/app"];var a=i.n(n);function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}function o(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,r(t,e)}const l=flarum.core.compat["admin/components/ExtensionPage"];var s=i.n(l);const c=flarum.core.compat["common/components/Button"];var f=i.n(c),d=window.m,g=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).loading=void 0,e.gifs=void 0,e.newGif=void 0,e.editingId=void 0,e}o(e,t);var i=e.prototype;return i.oninit=function(e){t.prototype.oninit.call(this,e),this.loading=!1,this.gifs=[],this.newGif={title:"",url:"",category:""},this.editingId=null,this.loadGifs()},i.content=function(){var t=this,e=a().translator,i=this.loading&&0===this.gifs.length,n=!this.loading&&0===this.gifs.length;return d("div",{className:"GifPickerAdminPage container"},d("div",{className:"GifPickerAdminPage-section"},d("h2",{className:"GifPickerAdminPage-heading"},String(e.trans("fw-ext-gif-picker.admin.management.add_heading"))),d("div",{className:"GifPickerAdminPage-fields"},d("div",{className:"Form-group"},d("label",{className:"Form-label"},String(e.trans("fw-ext-gif-picker.admin.management.fields.title_label"))),d("input",{className:"FormControl",placeholder:String(e.trans("fw-ext-gif-picker.admin.management.fields.title_placeholder")),value:this.newGif.title,oninput:function(e){return t.newGif.title=e.target.value}})),d("div",{className:"Form-group"},d("label",{className:"Form-label"},String(e.trans("fw-ext-gif-picker.admin.management.fields.category_label"))),d("input",{className:"FormControl",placeholder:String(e.trans("fw-ext-gif-picker.admin.management.fields.category_placeholder")),value:this.newGif.category,oninput:function(e){return t.newGif.category=e.target.value}})),d("div",{className:"Form-group"},d("label",{className:"Form-label"},String(e.trans("fw-ext-gif-picker.admin.management.fields.url_label"))),d("input",{className:"FormControl",placeholder:String(e.trans("fw-ext-gif-picker.admin.management.fields.url_placeholder")),value:this.newGif.url,oninput:function(e){return t.newGif.url=e.target.value}}))),d("div",{className:"GifPickerAdminPage-actionButtons"},d(f(),{className:"Button Button--primary",onclick:function(){return t.submitGif()},loading:this.loading},String(e.trans(this.editingId?"fw-ext-gif-picker.admin.management.fields.update_button":"fw-ext-gif-picker.admin.management.fields.submit_button"))),this.editingId?d(f(),{className:"Button",onclick:function(){return t.cancelEditing()},disabled:this.loading},String(e.trans("fw-ext-gif-picker.admin.management.fields.cancel_button"))):null)),d("div",{className:"GifPickerAdminPage-section"},d("h2",{className:"GifPickerAdminPage-heading"},String(e.trans("fw-ext-gif-picker.admin.management.list_heading"))),i?d("div",{className:"GifPickerAdminPage-status GifPickerAdminPage-status--loading"},String(e.trans("fw-ext-gif-picker.admin.management.loading"))):n?d("div",{className:"GifPickerAdminPage-status GifPickerAdminPage-status--empty"},String(e.trans("fw-ext-gif-picker.admin.management.empty"))):d("div",{className:"GifPickerAdminPage-tableWrapper"},d("table",{className:"Table GifPickerAdminPage-table"},d("thead",null,d("tr",null,d("th",null,String(e.trans("fw-ext-gif-picker.admin.management.table.title"))),d("th",null,String(e.trans("fw-ext-gif-picker.admin.management.table.category"))),d("th",null,String(e.trans("fw-ext-gif-picker.admin.management.table.preview"))),d("th",null,String(e.trans("fw-ext-gif-picker.admin.management.table.actions"))))),d("tbody",null,this.gifs.map(function(i,n){var a=i&&"function"==typeof i.id?String(i.id()):String(n),r=i&&"function"==typeof i.title?String(i.title()||""):"",o=i&&"function"==typeof i.category?String(i.category()||""):"",l=i&&"function"==typeof i.url?String(i.url()||""):"";return d("tr",{key:a||n},d("td",null,r||String(e.trans("fw-ext-gif-picker.admin.management.table.untitled"))),d("td",null,o||String(e.trans("fw-ext-gif-picker.admin.management.table.category_empty"))),d("td",{className:"GifPickerAdminPage-tablePreviewCell"},l?d("img",{className:"GifPickerAdminPage-thumb",src:l,alt:r||String(e.trans("fw-ext-gif-picker.admin.management.table.preview"))}):d("span",{className:"GifPickerAdminPage-noPreview"},"â€”")),d("td",{className:"GifPickerAdminPage-tableActions"},d(f(),{className:"Button",onclick:function(){return t.startEditing(i,a)},disabled:t.loading&&t.editingId!==a},String(e.trans("fw-ext-gif-picker.admin.management.actions.edit"))),d(f(),{className:"Button Button--danger",onclick:function(){return t.deleteGif(a)},loading:t.loading&&t.editingId===a},String(e.trans("fw-ext-gif-picker.admin.management.actions.delete")))))}))))))},i.loadGifs=function(){var t=this;this.loading=!0,d.redraw(),a().request({method:"GET",url:this.apiUrl("/global-gifs")}).then(function(e){t.gifs=e.data.map(function(t){return a().store.pushPayload({data:t})}).filter(function(t){return t})}).catch(function(e){console.error("[fw-ext/gif-picker] Failed to load global GIFs",e),t.gifs=[],a().alerts.show({type:"error",content:a().translator.trans("fw-ext-gif-picker.admin.management.load_error")})}).finally(function(){t.loading=!1,d.redraw()})},i.submitGif=function(){var t=a().translator;this.newGif.url.trim()?this.editingId?this.updateGif():this.createGif():alert(String(t.trans("fw-ext-gif-picker.admin.management.fields.url_required")))},i.createGif=function(){var t=this;this.loading=!0,a().store.createRecord("global-gifs").save({title:this.newGif.title,url:this.newGif.url,category:this.newGif.category||null}).then(function(){t.resetForm(),t.loadGifs()}).finally(function(){t.loading=!1})},i.updateGif=function(){var t=this;this.editingId&&(this.loading=!0,a().request({method:"PATCH",url:this.apiUrl("/global-gifs/"+this.editingId),body:{data:{type:"global-gifs",id:this.editingId,attributes:{title:this.newGif.title,url:this.newGif.url,category:this.newGif.category||null}}}}).then(function(){t.loadGifs(),t.resetForm()}).catch(function(t){console.error("[fw-ext/gif-picker] Failed to update global GIF",t),a().alerts.show({type:"error",content:a().translator.trans("fw-ext-gif-picker.admin.management.update_error")})}).finally(function(){t.loading=!1,d.redraw()}))},i.deleteGif=function(t){var e=this;this.loading=!0,a().request({method:"DELETE",url:this.apiUrl("/global-gifs/"+t)}).then(function(){e.editingId===t&&e.resetForm(),e.loadGifs()}).catch(function(t){console.error("[fw-ext/gif-picker] Failed to delete global GIF",t),a().alerts.show({type:"error",content:a().translator.trans("fw-ext-gif-picker.admin.management.delete_error")})}).finally(function(){e.loading=!1,d.redraw()})},i.startEditing=function(t,e){this.editingId=e,this.newGif={title:t&&"function"==typeof t.title?String(t.title()||""):"",url:t&&"function"==typeof t.url?String(t.url()||""):"",category:t&&"function"==typeof t.category?String(t.category()||""):""}},i.cancelEditing=function(){this.resetForm()},i.resetForm=function(){this.editingId=null,this.newGif={title:"",url:"",category:""}},i.apiUrl=function(t){var e=a().data&&a().data.apiUrl||(a().forum&&"function"==typeof a().forum.attribute?a().forum.attribute("apiUrl"):void 0);if(!e)throw new Error("[fw-ext/gif-picker] Unable to determine API URL in admin context");return""+e+t},e}(s());const u=flarum.core.compat["common/Model"];var m=i.n(u),p=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).title=m().attribute("title"),e.url=m().attribute("url"),e.category=m().attribute("category"),e}return o(e,t),e}(m()),h=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).title=m().attribute("title"),e.url=m().attribute("url"),e.userId=m().attribute("userId"),e.category=m().attribute("category"),e}return o(e,t),e}(m());const w=[].concat([]);a().initializers.add("fw-ext-gif-picker",function(){a().store.models["global-gifs"]=p,a().store.models["personal-gifs"]=h,a().extensionData.for("fw-ext-gif-picker").registerPage(g)})}},e={};function i(n){var a=e[n];if(void 0!==a)return a.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,i),r.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";i.r(n),i.d(n,{extend:()=>a.X});var t=i(3235),e={};for(const i in t)"default"!==i&&(e[i]=()=>t[i]);i.d(n,e);var a=i(8709)})(),module.exports=n})();
//# sourceMappingURL=admin.js.map